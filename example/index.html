<html>
	<head>
		<meta charset="utf-8">
		<title>demo</title>
	</head>
	<body>
		<div id="app"></div>

		<script src="../dist/regular-router.js"></script>
		<script src="./regular.js"></script>
		<script type="text/javascript">
			Regular.use( regularRouter );

			const App = {
				template: `
					<aside>Sidebar</aside>
					<section>
						<router-view name="aaa"></router-view>
					</section>
					<router-view></router-view>
				`,
				config() {
					// console.log( 'App config called' );
				}
			};

			const Display = {
				template: `
					<button on-click="{ this.onClick() }">like</button>
				`,
				onClick() {
					console.log( 'clicked' );
				},
				config() {
					// console.log( 'display' );
				},
			};

			const Btn = {
				template: `
					<button on-click="{ this.onClick() }">
						{#inc this.$body}
					</button>
				`,
				onClick() {
					console.log( 'clicked' );
				}
			}

			const Counter = {
				components: {
					Button: Btn,
				},
				template: `
					<Button>Btn</Button>
					{ count }
					<button on-click="{ this.onAdd() }">+</button>
					<button on-click="{ this.onMinus() }">-</button>
					<a href="#!/app/display">link</a>
					<router-view name="lll"></router-view>
				`,
				config() {
					this.data.count = 0;
					// console.log( 'Counter config called' );
				},
				route: {
					canEnter( { route, redirect, next } ) {
						// redirect( url ), for human, url is more understandable
						console.log( 'auth' );
						next();
					},
					canLeave( { next } ) {
						next();
					}
				},
				onAdd() {
					this.data.count++;
				},
				onMinus() {
					this.data.count--;
				}
			};

			// app -> App -> default + aaa
			// counter -> ↑ && display -> ↑
			// counter -> Counter -> lll

			const router = new regularRouter({
				routes: [
					{
						name: 'app',
						url: '/app',
						component: App,
						children: [
							{
								name: 'counter',
								url: 'counter',
								components: {
									aaa: Counter,
									default: {
										template: `
											ddd:
											<router-view name="ddd"></router-view>:
										`
									}
								},
								children: [
									{
										url: 'ccc',
										name: 'ccc',
										components: {
											ddd: {
												template: `ddd-jdasjdkasdsa`
											},
											lll: {
												template: `lll-jdasjdkasdsa`
											}
										}
									}
								]
							},
							{
								name: 'display',
								url: 'display',
								components: {
									aaa: Display,
								},
							}
						]
					}
				]
			});

			// router.beforeEach(function( transition ) {
			//
			// });

			// router.afterEach(function( transition ) {
			//
			// });

			router.start( '#app' );
		</script>
	</body>
</html>
